#!/bin/sh

function show_help() {
    echo "Shows diff of entire branch compared to the merge base (master by default)"
    echo
    echo "usage: git diff-branch [<branch> [<base>]]"
    echo
    echo "examples: git diff-branch"
    echo "          git diff-branch feat-something"
    echo "          git diff-branch feat-something v3.1"
}

while getopts "h?" opt; do
    case "$opt" in
	h|\?)
	    show_help
	    exit 0
	    ;;
    esac
done

branch="$1"
if [ -z "$branch" ]; then
    branch=$(git rev-parse --abbrev-ref HEAD)
fi

trunk="$2"
if [ -z "$trunk" ]; then
    trunk=master
fi

git diff "$branch..$trunk"

